(this["webpackJsonptshirt-editor"]=this["webpackJsonptshirt-editor"]||[]).push([[0],{73:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var r,a=n(8),c=n.n(a),i=n(44),o=n.n(i),u=n(17),l=n(52),s=n(78);!function(e){e.ChangeShirtModel="CHANGE_SHIRT_MODEL",e.ChangePartColor="CHANGE_PART_COLOR",e.SetPartList="SET_PART_LIST"}(r||(r={}));var d,p,j=n(79),f=n(80),b=n(21),m=n(12),h=function(e){var t=e.material,n=e.geometry;return Object(m.jsx)("mesh",{geometry:n,material:t})},O=function(){var e=Object(u.c)((function(e){return e.shirt.partList}));return e.length?Object(m.jsx)(a.Fragment,{children:Object(m.jsxs)(b.a,{camera:{position:[0,0,80]},children:[Object(m.jsx)(j.a,{target:[0,-10,0]}),Object(m.jsx)(f.a,{preset:"sunset"}),e.map((function(e){var t=e.geometry,n=e.material,r=e.uuid;return Object(m.jsx)(h,{geometry:t,material:n},r)}))]})}):null},g=function(){var e=Object(u.c)((function(e){return e.shirt.model})),t=Object(s.a)(e,!0),n=Object(u.b)();return Object(a.useEffect)((function(){var e,a=t.scene.children;n((e=a,{type:r.SetPartList,partList:e}))}),[n,t.scene]),Object(m.jsx)(O,{})},x=(n(73),{Shirt:"Shirt",Part:"Part"}),v=n(3),S=null,P=function(e,t){S||(S=new v.TextureLoader),S.load(t,(function(t){e.forEach((function(e){var n=e.material;t.wrapS=v.RepeatWrapping,t.wrapT=v.RepeatWrapping,t.flipY=!1,t.repeat.set(1.1,1.1);var r=t.clone();n.map=r,n.map.needsUpdate=!0,n.needsUpdate=!0,r.dispose()})),t.dispose()}))},T=function(e,t,n){if(e){S||(S=new v.TextureLoader);var r=t.find((function(t){return t.uuid===e})).material;S.load(n,(function(e){e.wrapS=v.RepeatWrapping,e.wrapT=v.RepeatWrapping,e.flipY=!1,e.repeat.set(1.1,1.1),r.map=e,r.map.needsUpdate=!0,r.needsUpdate=!0,e.dispose()}))}},C=function(e){e.forEach((function(e){var t=e.material;t.map&&(t.map.dispose(),t.map=null),t.normalMap&&(t.normalMap.dispose(),t.normalMap=null),t.bumpMap&&(t.bumpMap.dispose(),t.bumpMap=null),t.color.r=1,t.color.g=1,t.color.b=1,t.needsUpdate=!0}))},w=function(e,t){if(e){var n=t.find((function(t){return t.uuid===e})).material;n.map&&(n.map.dispose(),n.map=null),n.normalMap&&(n.normalMap.dispose(),n.normalMap=null),n.bumpMap&&(n.bumpMap.dispose(),n.bumpMap=null),n.color.r=1,n.color.g=1,n.color.b=1,n.needsUpdate=!0}},R=function(){var e=Object(u.c)((function(e){return e.shirt.partList})),t=Object(u.c)((function(e){return e.editor.mode})),n=Object(u.c)((function(e){return e.editor.selectedPartID})),r=Object(a.useRef)(null);return Object(m.jsxs)(a.Fragment,{children:["Color: \xa0",Object(m.jsx)("input",{type:"color",ref:r,defaultValue:"#ffffff"}),Object(m.jsx)("button",{onClick:function(){if(r.current){var a=r.current.value;t===x.Shirt?function(e,t){e.forEach((function(e){e.material.color=new v.Color(t)}))}(e,a):t===x.Part&&function(e,t,n){e||(t.find((function(t){return t.uuid===e})).material.color=new v.Color(n))}(n,e,a)}},children:"Apply Color"}),Object(m.jsx)("br",{})]})};!function(e){e.SetSelectedPart="SET_SELECTED_PART",e.SetEditorMode="SET_EDITOR_MODE",e.SetSelectedTexture="SET_SELECTED_TEXTURE",e.SetSelectedShape="SET_SELECTED_SHAPE",e.SetXPosition="SET_X_POSITION",e.SetYPosition="SET_Y_POSITION"}(d||(d={})),function(e){e.Shirt="Shirt",e.Part="Part"}(p||(p={}));var E=function(e){return{type:d.SetSelectedPart,selectedPartID:e}},M=function(e){return{type:d.SetSelectedTexture,selectedTexture:e}},L=function(){var e=Object.values(x),t=Object(u.c)((function(e){return e.editor.mode})),n=Object(u.b)(),r=function(e){var t,r=e.target.value;n((t=r,{type:d.SetEditorMode,mode:t}))};return Object(m.jsxs)(a.Fragment,{children:["Mode: \xa0",e.map((function(e){return Object(m.jsxs)(a.Fragment,{children:[Object(m.jsx)("input",{type:"radio",name:"editor_mode",value:e,defaultChecked:e===t,onClick:r}),Object(m.jsx)("label",{htmlFor:"model",children:e})]},e)})),Object(m.jsx)("br",{})]})},y=function(){var e=Object(u.c)((function(e){return e.shirt.partList})),t=Object(u.c)((function(e){return e.editor.selectedPartID})),n=Object(u.b)();return Object(a.useEffect)((function(){e.length&&!t&&n(E(e[0].uuid))})),Object(m.jsxs)(a.Fragment,{children:["Parts: \xa0",Object(m.jsx)("select",{onChange:function(e){var t=e.target.value;n(E(t))},className:"fullWidth",children:e.map((function(e){var t=e.name,n=e.uuid;return Object(m.jsx)("option",{value:n,children:t},n)}))}),Object(m.jsx)("br",{})]})},k=function(){var e=Object(u.c)((function(e){return e.editor.textureList})),t=Object(u.c)((function(e){return e.editor.selectedTexture})),n=Object(u.b)();return Object(m.jsxs)(a.Fragment,{children:[Object(m.jsx)("br",{}),"Texture: \xa0",Object(m.jsx)("select",{value:e.findIndex((function(e){return e.name===t.name})),onChange:function(t){var r=t.target.value;n(M(e[parseInt(r)]))},children:e.map((function(e,t){return Object(m.jsx)("option",{value:t,children:e.name},e.name)}))}),Object(m.jsx)("br",{})," ",Object(m.jsx)("br",{})]})},I=n(34),F=n(38),_={name:"None",map:null,normalMap:null},D=function(e){if(e){var t=new window.Image;return t.src=e,t}},N=function(e){e&&e.nodes([])},U=function(e,t,n){e.on("click",(function(){if(n){if(!n.nodes().find((function(t){return t===e})))return void n.nodes([e]);N(n)}})),t&&t.add(e)},W=(n(75),function(e){var t=e.handleAddImage,n=Object(a.useRef)(null);return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("label",{className:"label-button",children:["Add Image",Object(m.jsx)("input",{type:"file",onChange:function(){var e,r=n.current;r.files&&r.files[0]&&((e=new FileReader).onloadend=function(e){var n=e.target.result;t(n),r.value=null},e.readAsDataURL(r.files[0]))},ref:n,hidden:!0,accept:"image/png, image/gif, image/jpeg"})]})})}),A=function(e){var t=e.layer,n=e.transformer,r=Object(u.c)((function(e){return e.editor.shapeList})),c=Object(u.c)((function(e){return e.editor.selectedShape})),i=Object(u.b)();return Object(m.jsxs)(a.Fragment,{children:["Shape: \xa0",Object(m.jsx)("select",{defaultChecked:c.name,onChange:function(e){var t=e.target.value;i(function(e){return{type:d.SetSelectedShape,selectedShape:e}}(r[t]))},children:r.map((function(e,t){return Object(m.jsx)("option",{value:t,children:e.name},t)}))}),Object(m.jsx)("button",{onClick:function(){var e,r;U((e=c.type,r=c.config,new e(r)),t,n)},children:"Add Shape"})]})},Y=(n(76),function(){var e=.341*window.innerWidth,t=.342*window.innerWidth,n=Object(a.useRef)(null),r=Object(a.useRef)(null),c=Object(a.useRef)(null),i=Object(a.useRef)(null),o=Object(u.c)((function(e){return e.editor.selectedTexture})),l=Object(u.c)((function(e){return e.shirt.partList})),s=Object(u.c)((function(e){return e.editor.mode})),d=Object(u.c)((function(e){return e.editor.selectedPartID})),p=Object(u.b)();return Object(m.jsxs)(a.Fragment,{children:[Object(m.jsx)(A,{layer:c.current,transformer:i.current}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsxs)(F.d,{width:e,height:t,ref:n,className:"konva-canvas",children:[Object(m.jsxs)(F.b,{children:[Object(m.jsx)(F.c,{width:e,height:t,fill:"white"}),Object(m.jsx)(F.a,{image:D(o.map),width:e,height:t,ref:r,onClick:function(){return N(i.current)}})]}),Object(m.jsx)(F.b,{ref:c,children:Object(m.jsx)(F.e,{ref:i})})]}),Object(m.jsx)("br",{}),Object(m.jsx)(W,{handleAddImage:function(e){var t=new I.a.Image({image:D(e),width:50,height:50,draggable:!0});U(t,c.current,i.current)}}),Object(m.jsx)("button",{onClick:function(){if(n.current){var t=n.current,r=o.normalMap,a=void 0===r?null:r;if(N(i.current),s===x.Shirt){if("None"===o.name)return C(l),void P(l,t.toDataURL({pixelRatio:5}));P(l,t.toDataURL({pixelRatio:5})),function(e,t){t&&(S||(S=new v.TextureLoader),S.load(t,(function(t){e.forEach((function(e){var n=e.material;t.wrapS=v.RepeatWrapping,t.wrapT=v.RepeatWrapping,t.flipY=!1,t.repeat.set(1.1,1.1);var r=t.clone();n.normalMap=r,n.normalMap.needsUpdate=!0,n.needsUpdate=!0,r.dispose()})),t.dispose()})))}(l,a)}else if(s===x.Part){if("None"===o.name)return w(d,l),void T(d,l,t.toDataURL({pixelRatio:4096/e}));T(d,l,t.toDataURL({pixelRatio:4096/e})),function(e,t,n){if(e&&n){S||(S=new v.TextureLoader);var r=t.find((function(t){return t.uuid===e})).material;S.load(n,(function(e){e.wrapS=v.RepeatWrapping,e.wrapT=v.RepeatWrapping,e.flipY=!1,e.repeat.set(1.1,1.1),r.normalMap=e,r.normalMap.needsUpdate=!0,r.needsUpdate=!0,e.dispose()}))}}(d,l,a)}}},children:"Apply"}),Object(m.jsxs)("button",{onClick:function(){s===x.Part?w(d,l):s===x.Shirt&&C(l)},children:["Clear ",s]}),Object(m.jsx)("button",{onClick:function(){c.current&&c.current.getChildren((function(e){return"Transformer"!==e.getClassName()})).forEach((function(e){e.destroy()}));p(M(_))},children:"Clear Canvas"})]})}),X=function(){var e=Object(u.c)((function(e){return e.shirt.partList})),t=Object(u.c)((function(e){return e.editor.mode})),n=Object(u.c)((function(e){return e.editor.selectedPartID}));return Object(m.jsxs)(a.Fragment,{children:[Object(m.jsx)("br",{}),"X:",Object(m.jsx)("input",{type:"range",min:"-10",max:"10",defaultValue:"0",step:"0.01",onChange:function(r){var a=r.target.value;t===x.Shirt?function(e,t){e.forEach((function(e){var n=e.material;n.map&&(n.map.center.x=t)}))}(e,parseFloat(a)):t===x.Part&&function(e,t,n){if(t){var r=e.find((function(e){return e.uuid===t})).material;r.map&&(r.map.center.x=n)}}(e,n,parseFloat(a))}}),Object(m.jsx)("br",{}),"Y:",Object(m.jsx)("input",{type:"range",min:"-10",max:"10",defaultValue:"0",step:"0.01",onChange:function(r){var a=r.target.value;t===x.Shirt?function(e,t){e.forEach((function(e){var n=e.material;n.map&&(n.map.center.y=t)}))}(e,parseFloat(a)):t===x.Part&&function(e,t,n){if(t){var r=e.find((function(e){return e.uuid===t})).material;r.map&&(r.map.center.y=n)}}(e,n,parseFloat(a))}}),Object(m.jsx)("br",{}),"Scale:",Object(m.jsx)("input",{type:"range",min:"0.1",defaultValue:"1.1",max:"2",step:"0.01",onChange:function(r){var a=r.target.value;t===x.Shirt?function(e,t){e.forEach((function(e){var n=e.material;n.map&&n.map.repeat.set(1/t,1/t)}))}(e,parseFloat(a)):t===x.Part&&function(e,t,n){if(t){var r=e.find((function(e){return e.uuid===t})).material;r.map&&r.map.repeat.set(1/n,1/n)}}(e,n,parseFloat(a))}})]})},H=function(){var e=Object(u.c)((function(e){return e.editor.mode}));return Object(m.jsxs)(a.Fragment,{children:[Object(m.jsx)(L,{}),e===x.Part&&Object(m.jsx)(y,{}),Object(m.jsx)(R,{}),Object(m.jsx)(k,{}),Object(m.jsx)(Y,{}),Object(m.jsx)(X,{})]})},V=n(14),B=[{name:"None",map:null,normalMap:null},{name:"Carpet",map:n.p+"static/media/carpet.a8a11c0e.jpg",normalMap:n.p+"static/media/carpet.4fe521da.jpg"},{name:"Checkered Towel",map:n.p+"static/media/checkered_towel.d0ef6bb7.jpg",normalMap:n.p+"static/media/checkered_towel.c99b1a4b.jpg"},{name:"Leather",map:n.p+"static/media/leather.2a81cf18.jpg",normalMap:n.p+"static/media/leather.3cd1efa8.jpg"},{name:"Tight Knit",map:n.p+"static/media/tight_knit.7cd984c5.jpg",normalMap:n.p+"static/media/tight_knit.bdc5c65c.jpg"},{name:"Towel",map:n.p+"static/media/towel.cda81628.jpg",normalMap:n.p+"static/media/towel.6528b49b.jpg"}],G=[{name:"Rect",type:I.a.Rect,config:{width:50,height:50,fill:"red",stroke:"black",strokeWidth:2,draggable:!0}},{name:"Star",type:I.a.Star,config:{numPoints:5,innerRadius:20,outerRadius:30,fill:"red",stroke:"black",strokeWidth:2,draggable:!0}},{name:"Circle",type:I.a.Circle,config:{radius:25,fill:"red",stroke:"black",strokeWidth:2,draggable:!0}},{name:"Ring",type:I.a.Ring,config:{innerRadius:20,outerRadius:30,fill:"red",stroke:"black",strokeWidth:2,draggable:!0}}],J={mode:p.Shirt,selectedPartID:void 0,textureList:B,selectedTexture:B[0],shapeList:G,selectedShape:G[0],xPosition:0,yPosition:0},K={model:n.p+"static/media/model.91f3dcc5.glb",partList:[]},q=Object(l.a)({editor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0,n=t.type;switch(n){case d.SetSelectedPart:var r=t.selectedPartID;return Object(V.a)(Object(V.a)({},e),{},{selectedPartID:r});case d.SetEditorMode:var a=t.mode;return Object(V.a)(Object(V.a)({},e),{},{mode:a});case d.SetSelectedTexture:var c=t.selectedTexture;return Object(V.a)(Object(V.a)({},e),{},{selectedTexture:c});case d.SetSelectedShape:var i=t.selectedShape;return Object(V.a)(Object(V.a)({},e),{},{selectedShape:i});case d.SetXPosition:var o=t.xPosition;return Object(V.a)(Object(V.a)({},e),{},{xPosition:o});case d.SetYPosition:var u=t.yPosition;return Object(V.a)(Object(V.a)({},e),{},{yPosition:u});default:return e}},shirt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0,n=t.type;switch(n){case r.SetPartList:var a=t.partList;return Object(V.a)(Object(V.a)({},e),{},{partList:a});case r.ChangeShirtModel:var c=t.shirtModel;return Object(V.a)(Object(V.a)({},e),{},{shirtModel:c});default:return e}}}),z=function(){var e=Object(l.b)(q);return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(a.Suspense,{fallback:null,children:Object(m.jsx)(u.a,{store:e,children:Object(m.jsxs)("div",{className:"row",children:[Object(m.jsx)("div",{className:"editor",children:Object(m.jsx)(H,{})}),Object(m.jsx)("div",{className:"shirt",children:Object(m.jsx)(g,{})})]})})})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,81)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};o.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(z,{})}),document.getElementById("root")),Q()}},[[77,1,2]]]);
//# sourceMappingURL=main.8d5a9924.chunk.js.map